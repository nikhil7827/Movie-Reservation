{% extends "base.html" %}
{% block content %}
  <h1>Movies</h1>

  <!-- Display flash messages -->
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        <div class="alert alert-{{ category }}">{{ message }}</div>
      {% endfor %}
    {% endif %}
  {% endwith %}

  <!-- List of movies -->
  <ul>
    {% for movie in movies %}
      <li>{{ movie.title }} ({{ movie.genre }}) - {{ movie.description }}</li>
    {% endfor %}
  </ul>

  <!-- Add movie form (visible to admins only) -->
  {% if current_user.is_authenticated and current_user.role == 'admin' %}
    <h2>Add a New Movie</h2>
    <form method="POST" action="{{ url_for('movie.add_movie') }}">
      <div>
        <label for="title">Title:</label>
        <input type="text" id="title" name="title" required>
      </div>
      <div>
        <label for="description">Description:</label>
        <textarea id="description" name="description" required></textarea>
      </div>
      <div>
        <label for="genre">Genre:</label>
        <input type="text" id="genre" name="genre" required>
      </div>
      <div>
        <label for="poster_url">https://images.app.goo.gl/8cpw6UyHvMSSMTx17 </label>
        <input type="url" id="poster_url" name="poster_url">
      </div>
      <button type="submit">Add Movie</button>
    </form>
  {% endif %}
{% endblock %}